'use strict';var _extends=Object.assign||function(a){for(var c,b=1;b<arguments.length;b++)for(var d in c=arguments[b],c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d]);return a},_createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,'value'in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_propTypes=require('prop-types'),_propTypes2=_interopRequireDefault(_propTypes),_react=require('react'),_react2=_interopRequireDefault(_react),_SearchBox=require('../components/SearchBox'),_SearchBox2=_interopRequireDefault(_SearchBox);Object.defineProperty(exports,'__esModule',{value:!0});function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var itemsPropType=_propTypes2.default.arrayOf(_propTypes2.default.shape({value:_propTypes2.default.any,label:_propTypes2.default.string.isRequired,items:function items(){return itemsPropType.apply(void 0,arguments)}})),List=function(a){function b(){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.defaultProps={isFromSearch:!1},c.onShowMoreClick=function(){c.setState(function(d){return{extended:!d.extended}})},c.getLimit=function(){var d=c.props,f=d.limitMin,g=d.limitMax,h=c.state.extended;return h?g:f},c.resetQuery=function(){c.setState({query:''})},c.renderItem=function(d,f){var g=d.items&&_react2.default.createElement('div',c.props.cx('itemItems'),d.items.slice(0,c.getLimit()).map(function(h){return c.renderItem(h,d)}));return _react2.default.createElement('div',_extends({key:d.key||d.label},c.props.cx('item',d.isRefined&&'itemSelected',d.noRefinement&&'itemNoRefinement',g&&'itemParent',g&&d.isRefined&&'itemSelectedParent')),c.props.renderItem(d,f),g)},c.state={extended:!1,query:''},c}return _inherits(b,a),_createClass(b,[{key:'renderShowMore',value:function renderShowMore(){var c=this.props,d=c.showMore,f=c.translate,g=c.cx,h=this.state.extended,j=this.props.limitMin>=this.props.items.length;return d?_react2.default.createElement('button',_extends({disabled:j},g('showMore',j&&'showMoreDisabled'),{onClick:this.onShowMoreClick}),f('showMore',h)):null}},{key:'renderSearchBox',value:function renderSearchBox(){var c=this,d=this.props,f=d.cx,g=d.searchForItems,h=d.isFromSearch,j=d.translate,k=d.items,l=d.selectItem,m=0===k.length&&''!==this.state.query?_react2.default.createElement('div',f('noResults'),j('noResults')):null;return _react2.default.createElement('div',f('SearchBox'),_react2.default.createElement(_SearchBox2.default,{currentRefinement:this.state.query,refine:function refine(n){c.setState({query:n}),g(n)},focusShortcuts:[],translate:j,onSubmit:function onSubmit(n){n.preventDefault(),n.stopPropagation(),h&&l(k[0],c.resetQuery)}}),m)}},{key:'render',value:function render(){var c=this,d=this.props,f=d.cx,g=d.items,h=d.withSearchBox,j=d.canRefine,k=h?this.renderSearchBox():null;if(0===g.length)return _react2.default.createElement('div',f('root',!j&&'noRefinement'),k);var l=this.getLimit();return _react2.default.createElement('div',f('root',!this.props.canRefine&&'noRefinement'),k,_react2.default.createElement('div',f('items'),g.slice(0,l).map(function(m){return c.renderItem(m,c.resetQuery)})),this.renderShowMore())}}]),b}(_react.Component);List.propTypes={cx:_propTypes2.default.func.isRequired,translate:_propTypes2.default.func,items:itemsPropType,renderItem:_propTypes2.default.func.isRequired,selectItem:_propTypes2.default.func,showMore:_propTypes2.default.bool,limitMin:_propTypes2.default.number,limitMax:_propTypes2.default.number,limit:_propTypes2.default.number,show:_propTypes2.default.func,searchForItems:_propTypes2.default.func,withSearchBox:_propTypes2.default.bool,isFromSearch:_propTypes2.default.bool,canRefine:_propTypes2.default.bool},exports.default=List;